<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Sistem Gudang Realtime</title>
<script src="https://cdn.tailwindcss.com"></script>

<!-- Firebase v8 -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
</head>

<body class="bg-gray-100 p-6">

<h1 class="text-2xl font-bold mb-4">SISTEM GUDANG - REALTIME</h1>

<div class="bg-white p-4 rounded shadow mb-4">
  <h2 class="font-bold mb-2">Tambah Barang</h2>
  <input id="nama" placeholder="Nama Barang" class="border p-2 mr-2">
  <input id="stok" type="number" placeholder="Stok Awal" class="border p-2 mr-2">
  <input id="minimum" type="number" placeholder="Minimum Stok" class="border p-2 mr-2">
  <button onclick="tambahBarang()" class="bg-blue-500 text-white px-4 py-2 rounded">Simpan</button>
</div>

<div class="bg-white p-4 rounded shadow">
  <h2 class="font-bold mb-2">Daftar Barang</h2>
  <table class="w-full border">
    <thead>
      <tr class="bg-gray-200">
        <th class="border p-2">Nama</th>
        <th class="border p-2">Stok</th>
        <th class="border p-2">Minimum</th>
        <th class="border p-2">Aksi</th>
      </tr>
    </thead>
    <tbody id="tabelBarang"></tbody>
  </table>
</div>

<script>
// CONFIG FIREBASE ANDA
var firebaseConfig = {
  apiKey: "AIzaSyAucO3yaRtvL-v9zcK_6-ThNJVt-kRF3jg",
  authDomain: "gudang-anto-2026.firebaseapp.com",
  databaseURL: "https://gudang-anto-2026-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "gudang-anto-2026",
  storageBucket: "gudang-anto-2026.firebasestorage.app",
  messagingSenderId: "711961129196",
  appId: "1:711961129196:web:2ed2e74539e112dfff5c9"
};

firebase.initializeApp(firebaseConfig);
var database = firebase.database();

// TAMBAH BARANG
function tambahBarang() {
  var nama = document.getElementById("nama").value;
  var stok = parseInt(document.getElementById("stok").value);
  var minimum = parseInt(document.getElementById("minimum").value);

  if (!nama || isNaN(stok) || isNaN(minimum)) {
    alert("Isi semua data!");
    return;
  }

  var id = Date.now();

  database.ref("barang/" + id).set({
    nama: nama,
    stok: stok,
    minimum: minimum
  });

  document.getElementById("nama").value = "";
  document.getElementById("stok").value = "";
  document.getElementById("minimum").value = "";
}

// TAMPILKAN DATA REALTIME
database.ref("barang").on("value", function(snapshot) {
  var data = snapshot.val();
  var tabel = document.getElementById("tabelBarang");
  tabel.innerHTML = "";

  for (var id in data) {
    var barang = data[id];
    var warna = barang.stok <= barang.minimum ? "bg-red-200" : "";

    tabel.innerHTML += `
      <tr class="${warna}">
        <td class="border p-2">${barang.nama}</td>
        <td class="border p-2">${barang.stok}</td>
        <td class="border p-2">${barang.minimum}</td>
        <td class="border p-2">
          <button onclick="tambahStok('${id}')" class="bg-green-500 text-white px-2 py-1 rounded">+ Stok</button>
          <button onclick="kurangStok('${id}')" class="bg-yellow-500 text-white px-2 py-1 rounded">- Stok</button>
          <button onclick="hapusBarang('${id}')" class="bg-red-500 text-white px-2 py-1 rounded">Hapus</button>
        </td>
      </tr>
    `;
  }
});

// TAMBAH STOK
function tambahStok(id) {
  var jumlah = prompt("Tambah berapa?");
  if (!jumlah) return;

  database.ref("barang/" + id + "/stok").transaction(function(stok) {
    return (stok || 0) + parseInt(jumlah);
  });
}

// KURANG STOK
function kurangStok(id) {
  var jumlah = prompt("Kurang berapa?");
  if (!jumlah) return;

  database.ref("barang/" + id + "/stok").transaction(function(stok) {
    return (stok || 0) - parseInt(jumlah);
  });
}

// HAPUS
function hapusBarang(id) {
  if (confirm("Yakin hapus barang?")) {
    database.ref("barang/" + id).remove();
  }
}
</script>

</body>
</html>